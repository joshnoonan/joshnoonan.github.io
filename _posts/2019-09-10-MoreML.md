---
layout: post
title: More Machine Learning with Quarter Shooting Data
---

In my last post, I discussed the application of machine learning techniques to the quarter shooting data I had compiled in order to predict whether or not a team would make the playoffs. Based soley off of the z-score for a team's shooting performance in one quarter, we were able to achieve a roughly 66% success rate in predicting whether a team would make the playoffs. Upon further inspection of the places that the model was wrong, a large portion of the model's misses were on teams that had relatively strong offenses but miserable defenses. These teams might be scoring 110 a night, but they're giving up 120 to their opponents. With this in mind, I aimed to implement a parameter that could capture this, and settled upon net rating.

Net rating is a measure of a team's point differential per 100 possessions. It is calculated by subtracting a team's defensive rating (points allowed per 100 possessions) from their offensive rating (points scored per 100 possessions). Net rating itself is a fairly strong predictor of a team's playoff chances, as at a net rating of roughly 3.75 and higher, no team has ever failed to make the playoffs. Given this knowledge, I feel that a combination of net rating and z-scores from quarter shooting percentages would likely create an accurate model in predicting if a team will make the playoffs.

Without any further ado, let's get into constructing a k-nearest neighbors model to predict playoff chances.

As always, we'll start out with importing the necessary packages.
```python
import matplotlib.pyplot as plt
import pandas as pd
import pylab as pl
import numpy as np
%matplotlib inline
```

We'll then read in our data from a csv file aptly titled "everything.csv"
```python
qf = pd.read_csv("everything.csv")
qf.head(10)
```

We know need to add a column focusing specifically on whether or not a team made the playoffs, as the current format of the data has a column that represents how far a team advanced in the playoffs, but we want a simpler measure.
```python
qf['Playoff'] = [1 if x != 0 else 0 for x in qf['Playoff Points']]
qf.head(10)
```

We'll now eliminate columns that we don't need.
```python
bf = qf[['Team Name', 'Quarter' ,'Zscore' ,'Year', 'NRtg' ,'Playoff']]
bf.head()
```

Let's create a plot of all these data points, with a green dot representing a playoff team, and a red dot reprsenting a non-playoff (loterry) team.
```python
colors = ['green' if x > 0 else 'red' for x in qf['Playoff']]
plt.scatter(bf.Zscore, bf.NRtg,  s= 5, c=colors)
plt.xlabel("Z-Score")
plt.ylabel("Net Rating")
plt.show()
```
Which creates this figure ![Beautiful Figure](https://raw.githubusercontent.com/joshnoonan/joshnoonan.github.io/master/images/greenred.png)*Green = Playoffs, Red = No Playoffs*
